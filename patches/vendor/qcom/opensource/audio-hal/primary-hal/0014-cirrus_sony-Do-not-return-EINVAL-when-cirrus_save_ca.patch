From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Marijn Suijten <marijns95@gmail.com>
Date: Sat, 13 Feb 2021 15:36:09 +0100
Subject: [PATCH] cirrus_sony: Do not return -EINVAL when
 cirrus_save_calibration succeeds

Initializing ret to -EINVAL, but never updating it when everything is
sucessful results in a misleading:

    audio_hw_sony_cirrus_playback: cirrus_do_calibration: Cannot save calibration to file (-22)!!!

Signed-off-by: Marijn Suijten <marijns95@gmail.com>
---
 hal/audio_extn/cirrus_sony.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/hal/audio_extn/cirrus_sony.c b/hal/audio_extn/cirrus_sony.c
index b3be7d4eb31ba20b0f386a16f6f9010b11e91a74..95422b3e5ba970fe51706d9ad7a5286d749576c4 100644
--- a/hal/audio_extn/cirrus_sony.c
+++ b/hal/audio_extn/cirrus_sony.c
@@ -264,7 +264,7 @@ end:
 static int cirrus_save_calibration(struct cirrus_playback_session *hdl) {
     FILE* fp_calparams = NULL;
     struct cirrus_cal_file_t fdata;
-    int ret = -EINVAL;
+    int ret = 0;
 
     fp_calparams = fopen(CIRRUS_AUDIO_CAL_PATH, "wb");
     if (fp_calparams == NULL)
